<!DOCTYPE html>
<html>

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<link rel="manifest" href="/manifest.json">
	
	<script src="https://www.gstatic.com/firebasejs/4.1.3/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/4.1.3/firebase-messaging.js"></script>
	<script>
		"use strict";
		var coffeeLight = coffeeLight || {};
		
		coffeeLight.size = 0.7;
		
		coffeeLight.buttonClick = () => {
			fetch("./coffee", {
			  "method": "POST",
			  "headers": {
				"content-type": "application/json",
				"cache-control": "no-cache",
			  },
			  "body": JSON.stringify({
				"name": coffeeLight.loadName()
			  })
			});
		};
		
		coffeeLight.changeName = () => {
			var name = prompt("Name");
			document.getElementById("nameSpan").innerText = name;
			localStorage.setItem("coffeeLight.name", name);
		};
		
		coffeeLight.loadName = () => {
			name = localStorage.getItem("coffeeLight.name") || "Coffee Lover";
			document.getElementById("nameSpan").innerText = name;
			return name;
		};
		
		coffeeLight.setStyle = () => {
			var availableSpace = Math.min(window.innerHeight, window.innerWidth);
			var diameter = coffeeLight.size * availableSpace;
			coffeeLight.button.style.width  = diameter + "px";
			coffeeLight.button.style.height = diameter + "px";
			coffeeLight.button.style.fontSize = 1.5 * diameter + "%";
			coffeeLight.button.style.borderWidth = 0.04 * diameter + "px";
			coffeeLight.button.style.margin = ((window.innerHeight - diameter)/2 + "px") + " " + ((window.innerWidth - diameter)/2 + "px");
			
			var handleHeight = 0.05 * diameter;
			var handleWidth  = 0.15  * diameter;
			coffeeLight.handle.style.height = handleHeight + "px";
			coffeeLight.handle.style.width  = handleWidth  + "px";
			
			coffeeLight.handle.style.top  = (window.innerHeight - handleHeight)/2 + "px";
			coffeeLight.handle.style.left = (window.innerWidth - diameter)/2 - 0.95 * handleWidth + "px";
		}
		
		window.onload = () => {
			document.getElementById("changeNameBtn").onclick = coffeeLight.changeName;
			coffeeLight.button = document.getElementById("button");
			coffeeLight.button.onclick = coffeeLight.buttonClick;
			coffeeLight.handle = document.getElementById("handle");
			coffeeLight.setStyle();
			coffeeLight.loadName();
		};
		window.onresize = coffeeLight.setStyle;
	</script>
</head>

<body style="font-family: Arial; background-color: black; color: white;">
	<span>Hello <span id="nameSpan">Philipp</span>&nbsp;<button id="changeNameBtn">change name</button></span>
    <button id="button" style="position: absolute; top:0; left: 0; background: #6F4E37; color: white; border: solid; border-radius: 50%; width: 70%; height: 70%;">
		I want coffee!
	</button>
	<div id="handle" style="position: absolute; background-color: white; border-radius: 50% 0% 0% 50%">
		
	</div>
	<script src="app.js"></script>
</body>

</html>